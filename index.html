<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>who owns the emoji — demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- react 18 umd globals -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- chart.js for the history plot -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta name="color-scheme" content="light only">
    <style>html,body,#root{height:100%}</style>
  </head>
  <body class="bg-amber-50">
    <div id="root"></div>

    <script>
      const { useMemo, useState, useEffect, useRef } = React

      // ~60 emojis
      const EMOJIS = [
        { id:'grin', ch:'😀', label:'grinning', hue:'from-yellow-100 to-amber-100' },
        { id:'smile', ch:'😄', label:'smile', hue:'from-yellow-100 to-amber-100' },
        { id:'joy', ch:'😂', label:'joy', hue:'from-yellow-100 to-orange-100' },
        { id:'rofl', ch:'🤣', label:'rofl', hue:'from-yellow-100 to-orange-100' },
        { id:'heart', ch:'❤️', label:'heart', hue:'from-rose-100 to-pink-100' },
        { id:'hearts', ch:'😍', label:'hearts', hue:'from-rose-100 to-fuchsia-100' },
        { id:'kiss', ch:'😘', label:'kiss', hue:'from-rose-100 to-fuchsia-100' },
        { id:'sob', ch:'😭', label:'sob', hue:'from-sky-100 to-blue-100' },
        { id:'hot', ch:'🥵', label:'hot', hue:'from-orange-100 to-red-100' },
        { id:'cold', ch:'🥶', label:'cold', hue:'from-cyan-100 to-sky-100' },
        { id:'mind', ch:'🤯', label:'mind blown', hue:'from-purple-100 to-fuchsia-100' },
        { id:'cool', ch:'😎', label:'cool', hue:'from-yellow-100 to-emerald-100' },
        { id:'party', ch:'🥳', label:'party', hue:'from-purple-100 to-indigo-100' },
        { id:'skull', ch:'💀', label:'skull', hue:'from-stone-100 to-gray-100' },
        { id:'ghost', ch:'👻', label:'ghost', hue:'from-stone-100 to-gray-100' },
        { id:'alien', ch:'👽', label:'alien', hue:'from-cyan-100 to-green-100' },
        { id:'poo', ch:'💩', label:'poo', hue:'from-amber-100 to-orange-100' },
        { id:'pray', ch:'🙏', label:'pray', hue:'from-slate-100 to-zinc-100' },
        { id:'clap', ch:'👏', label:'clap', hue:'from-yellow-100 to-amber-100' },
        { id:'fire', ch:'🔥', label:'fire', hue:'from-orange-100 to-red-100' },
        { id:'star', ch:'⭐️', label:'star', hue:'from-yellow-100 to-amber-100' },
        { id:'sparkles', ch:'✨', label:'sparkles', hue:'from-yellow-100 to-amber-100' },
        { id:'zap', ch:'⚡️', label:'zap', hue:'from-yellow-100 to-orange-100' },
        { id:'boom', ch:'💥', label:'boom', hue:'from-orange-100 to-red-100' },
        { id:'rocket', ch:'🚀', label:'rocket', hue:'from-cyan-100 to-sky-100' },
        { id:'frog', ch:'🐸', label:'frog', hue:'from-lime-100 to-green-100' },
        { id:'cat', ch:'🐱', label:'cat', hue:'from-amber-100 to-yellow-100' },
        { id:'dog', ch:'🐶', label:'dog', hue:'from-amber-100 to-yellow-100' },
        { id:'fox', ch:'🦊', label:'fox', hue:'from-amber-100 to-orange-100' },
        { id:'panda', ch:'🐼', label:'panda', hue:'from-stone-100 to-gray-100' },
        { id:'bear', ch:'🐻', label:'bear', hue:'from-amber-100 to-orange-100' },
        { id:'lion', ch:'🦁', label:'lion', hue:'from-amber-100 to-orange-100' },
        { id:'unicorn', ch:'🦄', label:'unicorn', hue:'from-pink-100 to-fuchsia-100' },
        { id:'nosee', ch:'🙈', label:'no see', hue:'from-stone-100 to-zinc-100' },
        { id:'banana', ch:'🍌', label:'banana', hue:'from-yellow-100 to-amber-100' },
        { id:'peach', ch:'🍑', label:'peach', hue:'from-rose-100 to-orange-100' },
        { id:'eggplant', ch:'🍆', label:'eggplant', hue:'from-purple-100 to-indigo-100' },
        { id:'pizza', ch:'🍕', label:'pizza', hue:'from-amber-100 to-orange-100' },
        { id:'taco', ch:'🌮', label:'taco', hue:'from-amber-100 to-yellow-100' },
        { id:'sushi', ch:'🍣', label:'sushi', hue:'from-rose-100 to-orange-100' },
        { id:'coffee', ch:'☕️', label:'coffee', hue:'from-stone-100 to-zinc-100' },
        { id:'beer', ch:'🍺', label:'beer', hue:'from-amber-100 to-yellow-100' },
        { id:'wine', ch:'🍷', label:'wine', hue:'from-rose-100 to-red-100' },
        { id:'boba', ch:'🧋', label:'boba', hue:'from-amber-100 to-orange-100' },
        { id:'gift', ch:'🎁', label:'gift', hue:'from-rose-100 to-pink-100' },
        { id:'balloon', ch:'🎈', label:'balloon', hue:'from-rose-100 to-red-100' },
        { id:'trophy', ch:'🏆', label:'trophy', hue:'from-yellow-100 to-amber-100' },
        { id:'medal', ch:'🥇', label:'gold', hue:'from-yellow-100 to-amber-100' },
        { id:'gem', ch:'💎', label:'gem', hue:'from-cyan-100 to-sky-100' },
        { id:'ring', ch:'💍', label:'ring', hue:'from-amber-100 to-yellow-100' },
        { id:'money', ch:'💸', label:'money', hue:'from-emerald-100 to-green-100' },
        { id:'chart', ch:'📈', label:'chart up', hue:'from-emerald-100 to-green-100' },
        { id:'laptop', ch:'💻', label:'laptop', hue:'from-slate-100 to-zinc-100' },
        { id:'floppy', ch:'💾', label:'save', hue:'from-slate-100 to-zinc-100' },
        { id:'link', ch:'🔗', label:'link', hue:'from-slate-100 to-zinc-100' },
        { id:'lock', ch:'🔒', label:'lock', hue:'from-slate-100 to-zinc-100' },
        { id:'key', ch:'🔑', label:'key', hue:'from-amber-100 to-yellow-100' },
        { id:'globe', ch:'🌍', label:'earth', hue:'from-emerald-100 to-green-100' },
        { id:'moon', ch:'🌙', label:'moon', hue:'from-indigo-100 to-blue-100' },
        { id:'sun', ch:'☀️', label:'sun', hue:'from-yellow-100 to-amber-100' },
      ]

      // ==== economy knobs (front-loaded growth with taper, no plateau) ====
      const BASE_PRICE    = 0.1
      const TARGET_PRICE  = 500      // ~where we want to be around TARGET_STEALS
      const TARGET_STEALS = 100
      const R_MAX = 0.20             // spicy early jumps (~20%)
      const R_MIN = 0.05             // late-stage floor (~5%) => never flat

      // solve decay k so ∏_{i=0..TARGET_STEALS-1} (1 + R(i)) ≈ TARGET/BASE
      function solveDecayK() {
        const goal = TARGET_PRICE / BASE_PRICE
        let lo = 0, hi = 1.5
        const prodAt = (k) => {
          let prod = 1
          for (let i = 0; i < TARGET_STEALS; i++) {
            const r = R_MIN + (R_MAX - R_MIN) * Math.exp(-k * i)
            prod *= (1 + r)
            if (!isFinite(prod)) return Infinity
          }
          return prod
        }
        for (let it = 0; it < 60; it++) {
          const mid = (lo + hi) / 2
          if (prodAt(mid) < goal) hi = mid; else lo = mid
        }
        return (lo + hi) / 2
      }
      const DECAY_K = solveDecayK()

      const rateAt = (stealsSoFar) =>
        R_MIN + (R_MAX - R_MIN) * Math.exp(-DECAY_K * Math.max(0, stealsSoFar))

      const short = (addr) => (addr ? addr.slice(0,4)+'…'+addr.slice(-4) : '')
      function randomOwner() {
        const alphabet = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'
        let s = ''; for (let i = 0; i < 44; i++) s += alphabet[Math.floor(Math.random()*alphabet.length)]
        return s
      }

      // scheduled bump using the dynamic rate at the current step
      const bumpScheduled = (p, stealsSoFar) => Number((p * (1 +*
